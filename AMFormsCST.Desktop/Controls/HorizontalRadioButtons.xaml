<UserControl x:Class="AMFormsCST.Desktop.Controls.HorizontalRadioButtons"    
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"    
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"     
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"     
             xmlns:local="clr-namespace:AMFormsCST.Desktop.Controls"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:converters="clr-namespace:AMFormsCST.Desktop.Converters"    
             mc:Ignorable="d"     
             d:DesignHeight="50" d:DesignWidth="300"    
             x:Name="RadioButtonControl">

    <UserControl.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:BooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" Invert="True" />
        <converters:RadioButtonCommandParameterConverter x:Key="CommandParameterConverter" />
        <converters:ContentFallbackConverter x:Key="FallbackConverter" />
        <Style TargetType="RadioButton" BasedOn="{StaticResource {x:Type ToggleButton}}"/>
    </UserControl.Resources>

    <Grid HorizontalAlignment="Stretch" Margin="0,0,0,0">
        <ScrollViewer VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Visible">
            <ItemsControl ItemsSource="{Binding ItemsSource, ElementName=RadioButtonControl}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <RadioButton IsChecked="{Binding IsSelected, Mode=OneWay}"    
                                     Command="{Binding RadioButtonCommand, ElementName=RadioButtonControl}"
                                     Margin="0,0,5,10"    
                                     MinWidth="10"    
                                     GroupName="{Binding GroupName, RelativeSource={RelativeSource AncestorType=local:HorizontalRadioButtons}}"
                                     HorizontalContentAlignment="Stretch">

                            <RadioButton.CommandParameter>
                                <MultiBinding Converter="{StaticResource CommandParameterConverter}">
                                    <Binding Path="." />
                                    <Binding Path="CommandParameterPath" ElementName="RadioButtonControl" />
                                </MultiBinding>
                            </RadioButton.CommandParameter>

                            <RadioButton.Content>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock VerticalAlignment="Center" Grid.Column="0">
                                        <TextBlock.Text>
                                            <MultiBinding Converter="{StaticResource FallbackConverter}">
                                                <Binding Path="." Mode="OneWay" />
                                                <Binding Path="ContentBindingPath" ElementName="RadioButtonControl" />
                                                <Binding Path="ContentFallbackValue" ElementName="RadioButtonControl" />
                                                <Binding Path="RefreshTrigger" ElementName="RadioButtonControl" Mode="OneWay" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                    <ui:Button Grid.Column="1"
                            Command="{Binding DeleteCommand, ElementName=RadioButtonControl}"
                            CommandParameter="{Binding}"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            Margin="5,0,0,0"
                            Padding="2"
                            Height="20" Width="{Binding ActualHeight, RelativeSource={RelativeSource Self}}">
                                        <ui:Button.Visibility>
                                            <Binding Path="IsBlank" Converter="{StaticResource InverseBooleanToVisibilityConverter}" />
                                        </ui:Button.Visibility>
                                        <ui:Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Opacity" Value="0" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="#22FFFFFF" BorderBrush="Transparent" CornerRadius="10">
                                                                <ContentPresenter />
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=RadioButton}}" Value="True">
                                                        <DataTrigger.EnterActions>
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.2" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </DataTrigger.EnterActions>
                                                        <DataTrigger.ExitActions>
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </DataTrigger.ExitActions>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ui:Button.Style>
                                        <TextBlock Text="x" Foreground="DarkGray" FontWeight="Bold"  VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="18" Margin="0,0,0,4"/>
                                    </ui:Button>
                                </Grid>
                            </RadioButton.Content>
                        </RadioButton>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.Resources>
                    <Style TargetType="RadioButton" BasedOn="{StaticResource DefaultToggleButtonStyle}"/>
                </ItemsControl.Resources>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>